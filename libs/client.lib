<?php

/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

require_once ('Db/Db.php');

class Client 
{
    private $db;
    public function __construct() {
        
        $this->db = new Db();
        $this->tpl = new Client_Smarty;

    }
    
    public function getall(){
        $query = ("SELECT * FROM client");
        $params = null;

        $users = $this->db->select($query, $params);

        foreach ($users as $row) 
        {
            $rows[] = $row;
        }
        
//        print("<pre>".print_r($rows,true)."</pre>");
        return $rows;
    }
   
    
    public function displayclients($data = array()){
        
    $this->tpl->assign('data', $data);
    $this->tpl->display('allclients.tpl');   
    
    }
    public function showloginform(){ 
        $this->tpl->display('Login.tpl');   
        
    }
    
    public function login() {
        session_start();
        
        if (!empty($_POST)) {
            
            $username = ($_POST['username']);
            $password = ($_POST['password']);
        
            $query = ("SELECT CLIENTID, USERNAME FROM client WHERE USERNAME = '$username' AND PASSWORD = '$password'");
            $params = null;
            $login = $this->db->select($query, $params);

            if ($login!=null) {
 
		$_SESSION['id'] = $login[0]["CLIENTID"];
		$_SESSION['username'] = $login[0]["USERNAME"];
 
		echo "<p>teste: {$_SESSION['username']}</p>";
            }
        
        }
    
    
    }
    
    public function logout() {
        
        session_start();
        session_destroy();
    
    }
}